# -*- coding: utf-8 -*-

# Copyright (C) 2012-2014 by László Nagy
# This file is part of Bear.
#
# Bear is a tool to generate compilation database for clang tooling.
#
# Bear is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# Bear is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

import os
import os.path
import lit.util

# test_source_root: The root path where tests are located.
this_dir = os.path.dirname(__file__)
tool_dir = os.path.join(this_dir, 'tools')

config.environment['test_input_dir'] = os.path.join(this_dir, 'Input')

config.environment['CC'] = 'cc'
config.environment['CXX'] = 'c++'

config.substitutions.append(
    ('%{python}',
    sys.executable))
config.substitutions.append(
    ('%{bear}',
    lit_config.params['EAR_EXE']))
config.substitutions.append(
    ('%{libear}',
    lit_config.params['EAR_LIB']))
config.substitutions.append(
    ('%{intercept-build}',
    '{python} {bear} -l {libear} -vvvv'.format(python=sys.executable,
                                               bear=lit_config.params['EAR_EXE'],
                                               libear=lit_config.params['EAR_LIB'])))
config.substitutions.append(
    ('%{cdb_diff}',
    '{python} {cdb_diff}'.format(python=sys.executable,
                                 cdb_diff=os.path.join(tool_dir, 'cdb_diff.py'))))
